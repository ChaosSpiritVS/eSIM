<!doctype html>
<html lang="zh-Hans">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>关于 eSIM Home</title>
    <link rel="stylesheet" href="/public/help/styles.css">
    <script src="about.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mammoth@1.6.0/mammoth.browser.min.js"></script>
  </head>
  <body>
    <div class="screen">
      <div class="content" id="content"></div>
    </div>
    <script>
      const lang = detectLang();
      document.documentElement.lang = lang==='zh' ? 'zh-Hans' : 'en';
      const url = new URL(window.location.href);
      const topic = url.searchParams.get('topic') || (lang==='zh' ? '关于 eSIM Home' : 'About eSIM Home');
      const content = document.getElementById('content');
      renderLangToggle(content, lang, topic);
      const card = document.createElement('div'); card.className='card';
      const container = document.createElement('div');
      container.id = 'docx';
      container.style.padding = '8px 4px';
      card.appendChild(container);
      content.appendChild(card);
      const base = getAboutBase();
      const folder = getLangFolder(lang);
      function fetchDoc(p) { return fetch(encodeURI(p)).then(r=>{ if(!r.ok) throw new Error('HTTP '+r.status); return r.arrayBuffer(); }); }
      const cnTopic = '关于 eSIM Home';
      const enTopic = 'About eSIM Home';
      const candidates = [
        `${base}/${topic}/${folder}/${topic}.docx`,
        `${base}/${topic}/zh-Hans/${cnTopic}.docx`,
        `${base}/${topic}/en/${enTopic}.docx`,
        `${base}/${topic}/${topic}.docx`
      ];
      (async function(){
        let buffer = null, used = null;
        for (const p of candidates) {
          try { buffer = await fetchDoc(p); used = p; break; } catch(_) {}
        }
        if (buffer) {
          const res = await mammoth.convertToHtml({arrayBuffer: buffer});
          container.innerHTML = res.value || ''; pruneRedundantTitle(container, topic);
        } else {
          const msg = lang==='zh' ? '无法读取文档，点击下载查看：' : 'Unable to read document. Download: ';
          const dl = encodeURI(candidates[0]);
          container.innerHTML = `<div class="helper">${msg}<a class="link" href="${dl}">${topic || 'Document'}</a></div>`;
        }
      })();
    </script>
  </body>
  </html>
